<!doctype html><html lang=en-us dir=ltr><head><meta charset=utf-8><meta name=viewport content="width=device-width,initial-scale=1"><meta name=description content="Kernel de imagen # 1. Introducción # En este parte del taller se busca aplicar distintos kernels de imagén junto con varias herramientas de luminosidad o brillo de imagén, partiendo de varios conceptos que serán detallados en el siguiente punto.
2. Revisión bibliográfica # Convolución # Antes que nada, es necesario entender brevemente ¿Qué es una convolución? aplicado al procesamiento de imágenes.
La convolución dentro del procesamiento de imágenes, es el proceso de transformar una imagén aplicando unos valores de un kernel sobre cada píxel y sus vecinos locales."><meta name=theme-color content="#FFFFFF"><meta name=color-scheme content="light dark"><meta property="og:title" content><meta property="og:description" content="Kernel de imagen # 1. Introducción # En este parte del taller se busca aplicar distintos kernels de imagén junto con varias herramientas de luminosidad o brillo de imagén, partiendo de varios conceptos que serán detallados en el siguiente punto.
2. Revisión bibliográfica # Convolución # Antes que nada, es necesario entender brevemente ¿Qué es una convolución? aplicado al procesamiento de imágenes.
La convolución dentro del procesamiento de imágenes, es el proceso de transformar una imagén aplicando unos valores de un kernel sobre cada píxel y sus vecinos locales."><meta property="og:type" content="article"><meta property="og:url" content="https://jsalasm.github.io/VisualComputing2022_2/docs/workshop-1/masking/"><meta property="article:section" content="docs"><meta property="article:modified_time" content="2022-10-18T12:30:03-05:00"><title>Masking | Showcase Template</title><link rel=manifest href=/VisualComputing2022_2/manifest.json><link rel=icon href=/VisualComputing2022_2/favicon.png type=image/x-icon><link rel=stylesheet href=/VisualComputing2022_2/book.min.ab46de3e725a6415339a37bba23a0067534a37289b063c9f8d011515a63097a8.css integrity="sha256-q0bePnJaZBUzmje7ojoAZ1NKNyibBjyfjQEVFaYwl6g=" crossorigin=anonymous><script defer src=/VisualComputing2022_2/flexsearch.min.js></script>
<script defer src=/VisualComputing2022_2/en.search.min.33c839a5736686ae154a8a0b91255bb4e57f6150a068b6e42f61967c473e59f7.js integrity="sha256-M8g5pXNmhq4VSooLkSVbtOV/YVCgaLbkL2GWfEc+Wfc=" crossorigin=anonymous></script></head><body dir=ltr><input type=checkbox class="hidden toggle" id=menu-control>
<input type=checkbox class="hidden toggle" id=toc-control><main class="container flex"><aside class=book-menu><div class=book-menu-content><nav><h2 class=book-brand><a class="flex align-center" href=/VisualComputing2022_2/><span>Showcase Template</span></a></h2><div class=book-search><input type=text id=book-search-input placeholder=Search aria-label=Search maxlength=64 data-hotkeys=s/><div class="book-search-spinner hidden"></div><ul id=book-search-results></ul></div><ul><li><a href=/VisualComputing2022_2/docs/authors/>Authors</a></li><li><a href=/VisualComputing2022_2/docs/logs/>Logs</a></li><li><input type=checkbox id=section-cb5166b5972776a786c8f0abb960e1df class=toggle checked>
<label for=section-cb5166b5972776a786c8f0abb960e1df class="flex justify-between"><a role=button>Workshop 1</a></label><ul><li><a href=/VisualComputing2022_2/docs/workshop-1/Illusions/>Illusions</a></li><li><a href=/VisualComputing2022_2/docs/workshop-1/masking/ class=active>Masking</a></li></ul></li><li><input type=checkbox id=section-b3489b1dba5179c28e00fd119bd3b043 class=toggle>
<label for=section-b3489b1dba5179c28e00fd119bd3b043 class="flex justify-between"><a role=button>Workshop 2</a></label><ul><li><a href=/VisualComputing2022_2/docs/workshop-2/ames_window/>Ames Window</a></li><li><a href=/VisualComputing2022_2/docs/workshop-2/color-shading/>Color Shading</a></li><li><input type=checkbox id=section-d454431037e3917925119827f2181f03 class=toggle>
<label for=section-d454431037e3917925119827f2181f03 class="flex justify-between"><a role=button>Terrain and Waves</a></label><ul><li><a href=/VisualComputing2022_2/docs/workshop-2/terrain-and-waves/first-wave/>First Wave</a></li><li><a href=/VisualComputing2022_2/docs/workshop-2/terrain-and-waves/second-wave/>Second Wave</a></li><li><a href=/VisualComputing2022_2/docs/workshop-2/terrain-and-waves/terrain/>Terrain</a></li></ul></li></ul></li><li><input type=checkbox id=section-3c4185de2aea1fe13650a7c00ebf7f0d class=toggle>
<label for=section-3c4185de2aea1fe13650a7c00ebf7f0d class="flex justify-between"><a role=button>Workshop 3</a></label><ul><li><a href=/VisualComputing2022_2/docs/workshop-3/2.-Texturing/>2. Texturing</a></li><li><a href=/VisualComputing2022_2/docs/workshop-3/4.-Procedural-Texturing/>4. Procedural Texturing</a></li><li><a href=/VisualComputing2022_2/docs/workshop-3/5.-Non-Euclidean-Geometry/>5. Non Euclidean Geometry</a></li></ul></li></ul><ul><li><a href=/VisualComputing2022_2/posts/>Blog</a></li></ul></nav><script>(function(){var e=document.querySelector("aside .book-menu-content");addEventListener("beforeunload",function(){localStorage.setItem("menu.scrollTop",e.scrollTop)}),e.scrollTop=localStorage.getItem("menu.scrollTop")})()</script></div></aside><div class=book-page><header class=book-header><div class="flex align-center justify-between"><label for=menu-control><img src=/VisualComputing2022_2/svg/menu.svg class=book-icon alt=Menu></label>
<strong>Masking</strong>
<label for=toc-control><img src=/VisualComputing2022_2/svg/toc.svg class=book-icon alt="Table of Contents"></label></div><aside class="hidden clearfix"><nav id=TableOfContents><ul><li><a href=#kernel-de-imagen>Kernel de imagen</a><ul><li><a href=#1-introducción>1. Introducción</a></li><li><a href=#2-revisión-bibliográfica>2. Revisión bibliográfica</a></li><li><a href=#convolución>Convolución</a></li><li><a href=#kernel>Kernel</a></li><li><a href=#luminosidad>Luminosidad</a></li></ul></li><li><a href=#3-métodos>3. Métodos</a></li><li><a href=#4-resultados>4. Resultados</a><ul><li><a href=#referencias>Referencias</a></li></ul></li></ul></nav></aside></header><article class=markdown><h1 id=kernel-de-imagen>Kernel de imagen
<a class=anchor href=#kernel-de-imagen>#</a></h1><h2 id=1-introducción>1. Introducción
<a class=anchor href=#1-introducci%c3%b3n>#</a></h2><p>En este parte del taller se busca aplicar distintos kernels de imagén junto con varias herramientas de luminosidad o brillo de imagén, partiendo de varios conceptos que serán detallados en el siguiente punto.</p><h2 id=2-revisión-bibliográfica>2. Revisión bibliográfica
<a class=anchor href=#2-revisi%c3%b3n-bibliogr%c3%a1fica>#</a></h2><h2 id=convolución>Convolución
<a class=anchor href=#convoluci%c3%b3n>#</a></h2><p>Antes que nada, es necesario entender brevemente <em>¿Qué es una convolución?</em> aplicado al procesamiento de imágenes.</p><p>La convolución dentro del procesamiento de imágenes, es el proceso de transformar una imagén aplicando unos valores de un kernel sobre cada píxel y sus vecinos locales.</p><p>Para realizar la convolución de una imagen, primero se multiplican los valores tanto del píxel seleccionado como los de sus vecinos locales por su respectivo valor de la matriz del kernel, y luego se realiza una sumatoria de cada uno de los valores obtenidos para así obtener el valor del píxel seleccionado.</p><p>De esta forma cada píxel toma un nuevo valor mediante la medida ponderada de los pixeles contiguos.</p><h2 id=kernel>Kernel
<a class=anchor href=#kernel>#</a></h2><p>El kernel es una matriz
<link rel=stylesheet href=/VisualComputing2022_2/katex/katex.min.css><script defer src=/VisualComputing2022_2/katex/katex.min.js></script>
<script defer src=/VisualComputing2022_2/katex/auto-render.min.js onload=renderMathInElement(document.body)></script><span>
\(M{\times}M\)</span>
cuyos valores determinan la transformación que sufrirá la imagen original, ya sea para difuminar, detectar ejes o aumentar su nitidez.</p><p>Algunos kernels usados en este taller son:</p><ul><li>Identidad:</li></ul><span>\[\begin{bmatrix}
0 & 0 & 0\\
0 & 1 & 0\\
0 & 0 & 0
\end{bmatrix}\]</span><ul><li>Desenfoque de caja:</li></ul><span>\[\frac{1}{9}
\begin{bmatrix}
1 & 1 & 1\\
1 & 1 & 1\\
1 & 1 & 1
\end{bmatrix}\]</span><ul><li>Desenfoque gaussiano:</li></ul><span>\[\frac{1}{16}
\begin{bmatrix}
1 & 2 & 1\\
2 & 4 & 2\\
1 & 2 & 1
\end{bmatrix}\]</span><ul><li>Enfoque o afilado (Sharpen)
<span>\[\begin{bmatrix}
0 & -1 & 0\\
-1 & 5 & -1\\
0 & -1 & 0
\end{bmatrix}\]</span></li></ul><blockquote class="book-hint info"><strong>Ejemplo gŕafico -</strong> Operación de convolución de una imagen con el kernel de Sharpen:
<img src=https://miro.medium.com/max/1400/1*O06nY1U7zoP4vE5AZEnxKA.gif alt=Convolution style="height:300px;width:600px;margin:30px auto;display:block"></blockquote><h2 id=luminosidad>Luminosidad
<a class=anchor href=#luminosidad>#</a></h2><img src=https://c1.staticflickr.com/1/805/39523785660_ed4b725d9f_c.jpg alt=Luma style="height:350px;width:600px;margin:30px auto;display:block"><p>La luminosidad aplicada en este caso está asociada a una conversión del espacio de color RGB a un espacio de escala de grises aplicando métodos ponderados como también mediante la intensidad (método promedio), valor HSV y luminosidad HSL. Estos dos últimos transforman el espacio cartesiano RGB.</p><p>Se obtiene esta escala de grises debido a la luminancia, la cual representa el brillo de las componentes de blanco y negro, esta se crea a partir de las componentes del espacio RGB las cuales son multiplicadas independientemente por un valor especifico.</p><p>Dado que el ojo humano tiene un mayor sensibilidad a la luz verde, adquiere un mayor valor en la ponderación del luma (Y&rsquo;), seguido del rojo y a su vez del azul.</p><p><span>\[Y_{601}^{'} = 0.2989 \cdot R + 0.5870 \cdot G + 0.1140 \cdot B\]</span>
<span>\[Y_{240}^{'} = 0.212 \cdot R + 0.701 \cdot G + 0.087 \cdot B\]</span>
<span>\[Y_{709}^{'} = 0.2126 \cdot R + 0.7152 \cdot G + 0.0.0722 \cdot B\]</span>
<span>\[Y_{2020}^{'} = 0.2627 \cdot R + 0.6780 \cdot G + 0.0593 \cdot B \]</span></p><p>Por otra parte, los siguientes métodos no tienen en cuenta esta sensibilidad.</p><blockquote class="book-hint info">Nota: Se recomienda dividir por separado cada componente RGB con el fin de que no se sobrepase un valor de 255.</blockquote><p><span>\[Intensity = \frac{1}{3}(R + G + B) = \frac{R}{3} + \frac{G}{3} + \frac{B}{3}\]</span>
<span>\[HSV-Value = max(R, G, B)\]</span>
<span>\[HSL-Lightness = \frac{1}{2}(max(R, G, B) + min(R, G, B))\]</span></p><h1 id=3-métodos>3. Métodos
<a class=anchor href=#3-m%c3%a9todos>#</a></h1><p>Para la realización de este tema hicimos uso de los conceptos anteriormente expuestos, de tal forma que se presenta una implementación del procesamiento de imágenes mediante la convolución con distintos valores del kernel para lograr diferentes efectos, como también del brillo de una imagen mediante distintos métodos de luminosidad monocromática.</p><h1 id=4-resultados>4. Resultados
<a class=anchor href=#4-resultados>#</a></h1><details><summary>Atajos de teclado</summary><div class=markdown-inner><p>El manejo del kernel como del histograma se hace mediante teclado, mientras que para las herramientas de brillo es mediante el select y el slider.</p><table><thead><tr><th><strong>Tecla</strong></th><th><strong>Descripción</strong></th></tr></thead><tbody><tr><td><code>1</code></td><td>Imagen original</td></tr><tr><td><code>2</code></td><td>Desenfoque de caja</td></tr><tr><td><code>3</code></td><td>Enfoque o afilado (Sharpen)</td></tr><tr><td><code>4</code></td><td>Desenfoque Gaussiano</td></tr><tr><td><code>5</code></td><td>Detección de crestas (Ridges)</td></tr><tr><td><code>6</code></td><td>Operador Sobel</td></tr><tr><td><code>h</code></td><td>Mostrar u ocultar histograma</td></tr></tbody></table></div></details><iframe id=masking style=width:515px;height:515px;padding:0;border:none;background-color:#343a40;background:#343a40 srcdoc="
        <!DOCTYPE html>
        <html>
          <head>
            <script src=https://cdnjs.cloudflare.com/ajax/libs/p5.js/1.4.2/p5.min.js></script>
            <script src=https://cdnjs.cloudflare.com/ajax/libs/p5.js/1.4.2/addons/p5.sound.min.js></script>
            
            
            
            
            
            <script src=/VisualComputing2022_2/sketches/masking.js></script>
          </head>
          <style>
            body {
              background-color: #343a40;
            }
            </style>
          <body >
          </body>
        </html>
        " scrolling=no></iframe>
<details><summary>Código</summary><div class=markdown-inner><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-js data-lang=js><span style=display:flex><span><span style=color:#75715e>// Image kernel matrices
</span></span></span><span style=display:flex><span><span style=color:#75715e></span>
</span></span><span style=display:flex><span><span style=color:#75715e>// Matrix values taken from
</span></span></span><span style=display:flex><span><span style=color:#75715e>// - https://sbme-tutorials.github.io/2018/cv/notes/4_week4.html
</span></span></span><span style=display:flex><span><span style=color:#75715e>// - https://en.wikipedia.org/wiki/Kernel_%28image_processing%29
</span></span></span><span style=display:flex><span><span style=color:#75715e></span>
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span><span style=color:#66d9ef>const</span> <span style=color:#a6e22e>identityMatrix</span> <span style=color:#f92672>=</span> [[ <span style=color:#ae81ff>0</span>, <span style=color:#ae81ff>0</span>, <span style=color:#ae81ff>0</span> ],
</span></span><span style=display:flex><span>                        [ <span style=color:#ae81ff>0</span>, <span style=color:#ae81ff>1</span>, <span style=color:#ae81ff>0</span> ],
</span></span><span style=display:flex><span>                        [ <span style=color:#ae81ff>0</span>, <span style=color:#ae81ff>0</span>, <span style=color:#ae81ff>0</span> ]];
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span><span style=color:#66d9ef>const</span> <span style=color:#a6e22e>boxMatrix</span> <span style=color:#f92672>=</span> [[ <span style=color:#ae81ff>1</span><span style=color:#f92672>/</span><span style=color:#ae81ff>9</span>, <span style=color:#ae81ff>1</span><span style=color:#f92672>/</span><span style=color:#ae81ff>9</span>, <span style=color:#ae81ff>1</span><span style=color:#f92672>/</span><span style=color:#ae81ff>9</span> ],
</span></span><span style=display:flex><span>                   [ <span style=color:#ae81ff>1</span><span style=color:#f92672>/</span><span style=color:#ae81ff>9</span>, <span style=color:#ae81ff>1</span><span style=color:#f92672>/</span><span style=color:#ae81ff>9</span>, <span style=color:#ae81ff>1</span><span style=color:#f92672>/</span><span style=color:#ae81ff>9</span> ],
</span></span><span style=display:flex><span>                   [ <span style=color:#ae81ff>1</span><span style=color:#f92672>/</span><span style=color:#ae81ff>9</span>, <span style=color:#ae81ff>1</span><span style=color:#f92672>/</span><span style=color:#ae81ff>9</span>, <span style=color:#ae81ff>1</span><span style=color:#f92672>/</span><span style=color:#ae81ff>9</span> ]];
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span><span style=color:#66d9ef>const</span> <span style=color:#a6e22e>sharpenMatrix</span> <span style=color:#f92672>=</span> [[  <span style=color:#ae81ff>0</span>, <span style=color:#f92672>-</span><span style=color:#ae81ff>1</span>,  <span style=color:#ae81ff>0</span> ], 
</span></span><span style=display:flex><span>                       [ <span style=color:#f92672>-</span><span style=color:#ae81ff>1</span>,  <span style=color:#ae81ff>5</span>, <span style=color:#f92672>-</span><span style=color:#ae81ff>1</span> ],
</span></span><span style=display:flex><span>                       [  <span style=color:#ae81ff>0</span>, <span style=color:#f92672>-</span><span style=color:#ae81ff>1</span>,  <span style=color:#ae81ff>0</span> ]];
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span><span style=color:#66d9ef>const</span> <span style=color:#a6e22e>gaussianMatrix</span> <span style=color:#f92672>=</span> [[ <span style=color:#ae81ff>1</span><span style=color:#f92672>/</span><span style=color:#ae81ff>16</span>, <span style=color:#ae81ff>1</span><span style=color:#f92672>/</span><span style=color:#ae81ff>8</span>, <span style=color:#ae81ff>1</span><span style=color:#f92672>/</span><span style=color:#ae81ff>16</span> ],
</span></span><span style=display:flex><span>                        [ <span style=color:#ae81ff>1</span><span style=color:#f92672>/</span><span style=color:#ae81ff>8</span>,  <span style=color:#ae81ff>1</span><span style=color:#f92672>/</span><span style=color:#ae81ff>4</span>, <span style=color:#ae81ff>1</span><span style=color:#f92672>/</span><span style=color:#ae81ff>8</span> ],
</span></span><span style=display:flex><span>                        [ <span style=color:#ae81ff>1</span><span style=color:#f92672>/</span><span style=color:#ae81ff>16</span>, <span style=color:#ae81ff>1</span><span style=color:#f92672>/</span><span style=color:#ae81ff>8</span>, <span style=color:#ae81ff>1</span><span style=color:#f92672>/</span><span style=color:#ae81ff>16</span> ]];
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span><span style=color:#66d9ef>const</span> <span style=color:#a6e22e>ridgeDetectionMatrix</span> <span style=color:#f92672>=</span> [[ <span style=color:#f92672>-</span><span style=color:#ae81ff>1</span>, <span style=color:#f92672>-</span><span style=color:#ae81ff>1</span>, <span style=color:#f92672>-</span><span style=color:#ae81ff>1</span> ],
</span></span><span style=display:flex><span>                              [ <span style=color:#f92672>-</span><span style=color:#ae81ff>1</span>,  <span style=color:#ae81ff>8</span>, <span style=color:#f92672>-</span><span style=color:#ae81ff>1</span> ],
</span></span><span style=display:flex><span>                              [ <span style=color:#f92672>-</span><span style=color:#ae81ff>1</span>, <span style=color:#f92672>-</span><span style=color:#ae81ff>1</span>, <span style=color:#f92672>-</span><span style=color:#ae81ff>1</span> ]];  
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span><span style=color:#66d9ef>const</span> <span style=color:#a6e22e>sobelMatrix</span> <span style=color:#f92672>=</span> [[ <span style=color:#f92672>-</span><span style=color:#ae81ff>1</span>, <span style=color:#f92672>-</span><span style=color:#ae81ff>2</span>, <span style=color:#f92672>-</span><span style=color:#ae81ff>1</span> ],
</span></span><span style=display:flex><span>                     [  <span style=color:#ae81ff>0</span>,  <span style=color:#ae81ff>0</span>,  <span style=color:#ae81ff>0</span> ],
</span></span><span style=display:flex><span>                     [  <span style=color:#ae81ff>1</span>,  <span style=color:#ae81ff>2</span>,  <span style=color:#ae81ff>1</span> ]];
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span><span style=color:#66d9ef>const</span> <span style=color:#a6e22e>matrixSize</span> <span style=color:#f92672>=</span> <span style=color:#ae81ff>3</span>;
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span><span style=color:#75715e>// Luma Y&#39; values for brightness
</span></span></span><span style=display:flex><span><span style=color:#75715e></span>
</span></span><span style=display:flex><span><span style=color:#66d9ef>const</span> <span style=color:#a6e22e>y601</span> <span style=color:#f92672>=</span> [<span style=color:#ae81ff>0.299</span>, <span style=color:#ae81ff>0.587</span>, <span style=color:#ae81ff>0.114</span>];
</span></span><span style=display:flex><span><span style=color:#66d9ef>const</span> <span style=color:#a6e22e>y240</span> <span style=color:#f92672>=</span> [<span style=color:#ae81ff>0.212</span>, <span style=color:#ae81ff>0.701</span>, <span style=color:#ae81ff>0.087</span>];
</span></span><span style=display:flex><span><span style=color:#66d9ef>const</span> <span style=color:#a6e22e>y709</span> <span style=color:#f92672>=</span> [<span style=color:#ae81ff>0.2126</span>, <span style=color:#ae81ff>0.7152</span>, <span style=color:#ae81ff>0.0722</span>];
</span></span><span style=display:flex><span><span style=color:#66d9ef>const</span> <span style=color:#a6e22e>y2020</span> <span style=color:#f92672>=</span> [<span style=color:#ae81ff>0.2627</span>, <span style=color:#ae81ff>0.6780</span>, <span style=color:#ae81ff>0.0593</span>];
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span><span style=color:#66d9ef>let</span> <span style=color:#a6e22e>img</span>, <span style=color:#a6e22e>file</span>, <span style=color:#a6e22e>selection</span>, <span style=color:#a6e22e>slider</span>, <span style=color:#a6e22e>histogram</span> <span style=color:#f92672>=</span> [], <span style=color:#a6e22e>show</span> <span style=color:#f92672>=</span> <span style=color:#66d9ef>false</span>;
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span><span style=color:#66d9ef>function</span> <span style=color:#a6e22e>preload</span>() {
</span></span><span style=display:flex><span>    <span style=color:#a6e22e>file</span> <span style=color:#f92672>=</span> <span style=color:#a6e22e>loadImage</span>(<span style=color:#e6db74>&#34;/VisualComputing2022_2/docs/workshop/images/astronaut.jpg&#34;</span>);
</span></span><span style=display:flex><span>    <span style=color:#a6e22e>img</span> <span style=color:#f92672>=</span> <span style=color:#a6e22e>loadImage</span>(<span style=color:#e6db74>&#34;/VisualComputing2022_2/docs/workshop/images/astronaut.jpg&#34;</span>);
</span></span><span style=display:flex><span>}
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span><span style=color:#66d9ef>function</span> <span style=color:#a6e22e>setup</span>() {
</span></span><span style=display:flex><span>    <span style=color:#a6e22e>createCanvas</span>(<span style=color:#ae81ff>500</span>, <span style=color:#ae81ff>500</span>);
</span></span><span style=display:flex><span>    <span style=color:#a6e22e>pixelDensity</span>(<span style=color:#ae81ff>1</span>);
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>    <span style=color:#a6e22e>img</span>.<span style=color:#a6e22e>resize</span>(<span style=color:#ae81ff>0</span>,<span style=color:#ae81ff>500</span>);
</span></span><span style=display:flex><span>    <span style=color:#a6e22e>file</span>.<span style=color:#a6e22e>resize</span>(<span style=color:#ae81ff>0</span>,<span style=color:#ae81ff>500</span>);
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>    <span style=color:#a6e22e>selection</span> <span style=color:#f92672>=</span> <span style=color:#a6e22e>createSelect</span>();
</span></span><span style=display:flex><span>    <span style=color:#a6e22e>selection</span>.<span style=color:#a6e22e>position</span>(<span style=color:#ae81ff>10</span>, <span style=color:#ae81ff>10</span>);
</span></span><span style=display:flex><span>    <span style=color:#a6e22e>selection</span>.<span style=color:#a6e22e>option</span>(<span style=color:#e6db74>&#39;Y601&#39;</span>);
</span></span><span style=display:flex><span>    <span style=color:#a6e22e>selection</span>.<span style=color:#a6e22e>option</span>(<span style=color:#e6db74>&#39;Y240&#39;</span>);
</span></span><span style=display:flex><span>    <span style=color:#a6e22e>selection</span>.<span style=color:#a6e22e>option</span>(<span style=color:#e6db74>&#39;Y709&#39;</span>);
</span></span><span style=display:flex><span>    <span style=color:#a6e22e>selection</span>.<span style=color:#a6e22e>option</span>(<span style=color:#e6db74>&#39;Y2020&#39;</span>);
</span></span><span style=display:flex><span>    <span style=color:#a6e22e>selection</span>.<span style=color:#a6e22e>option</span>(<span style=color:#e6db74>&#39;Intensity&#39;</span>);
</span></span><span style=display:flex><span>    <span style=color:#a6e22e>selection</span>.<span style=color:#a6e22e>option</span>(<span style=color:#e6db74>&#39;HSV value&#39;</span>);
</span></span><span style=display:flex><span>    <span style=color:#a6e22e>selection</span>.<span style=color:#a6e22e>option</span>(<span style=color:#e6db74>&#39;HSL lightness&#39;</span>);
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>    <span style=color:#a6e22e>selection</span>.<span style=color:#a6e22e>selected</span>(<span style=color:#e6db74>&#39;Y709&#39;</span>);
</span></span><span style=display:flex><span>    <span style=color:#a6e22e>selection</span>.<span style=color:#a6e22e>changed</span>(<span style=color:#a6e22e>selectedValue</span>);
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>    <span style=color:#a6e22e>slider</span> <span style=color:#f92672>=</span> <span style=color:#a6e22e>createSlider</span>(<span style=color:#ae81ff>0</span>, <span style=color:#ae81ff>100</span>, <span style=color:#ae81ff>0</span>, <span style=color:#ae81ff>5</span>);
</span></span><span style=display:flex><span>    <span style=color:#a6e22e>slider</span>.<span style=color:#a6e22e>position</span>(<span style=color:#ae81ff>10</span>, <span style=color:#ae81ff>30</span>);
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>    <span style=color:#a6e22e>slider</span>.<span style=color:#a6e22e>changed</span>(() =&gt; {
</span></span><span style=display:flex><span>        <span style=color:#66d9ef>switch</span> (<span style=color:#a6e22e>selection</span>.<span style=color:#a6e22e>value</span>()) {
</span></span><span style=display:flex><span>            <span style=color:#66d9ef>case</span> <span style=color:#e6db74>&#39;Intensity&#39;</span><span style=color:#f92672>:</span>
</span></span><span style=display:flex><span>                <span style=color:#a6e22e>lightnessControl</span>();
</span></span><span style=display:flex><span>                <span style=color:#66d9ef>break</span>;
</span></span><span style=display:flex><span>            <span style=color:#66d9ef>case</span> <span style=color:#e6db74>&#39;HSV value&#39;</span><span style=color:#f92672>:</span>
</span></span><span style=display:flex><span>                <span style=color:#a6e22e>lightnessControl</span>();
</span></span><span style=display:flex><span>                <span style=color:#66d9ef>break</span>;
</span></span><span style=display:flex><span>            <span style=color:#66d9ef>case</span> <span style=color:#e6db74>&#39;HSL lightness&#39;</span><span style=color:#f92672>:</span>
</span></span><span style=display:flex><span>                <span style=color:#a6e22e>lightnessControl</span>();
</span></span><span style=display:flex><span>                <span style=color:#66d9ef>break</span>;
</span></span><span style=display:flex><span>            <span style=color:#66d9ef>default</span><span style=color:#f92672>:</span>
</span></span><span style=display:flex><span>                <span style=color:#a6e22e>brightnessControl</span>();
</span></span><span style=display:flex><span>                <span style=color:#66d9ef>break</span>;
</span></span><span style=display:flex><span>        }
</span></span><span style=display:flex><span>    });
</span></span><span style=display:flex><span>}
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span><span style=color:#66d9ef>function</span> <span style=color:#a6e22e>draw</span>(){
</span></span><span style=display:flex><span>    <span style=color:#a6e22e>image</span>(<span style=color:#a6e22e>img</span>, <span style=color:#ae81ff>0</span>, <span style=color:#ae81ff>0</span>);
</span></span><span style=display:flex><span>    <span style=color:#66d9ef>if</span>(<span style=color:#a6e22e>show</span>) <span style=color:#a6e22e>showHistogram</span>();
</span></span><span style=display:flex><span>}
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span><span style=color:#66d9ef>function</span> <span style=color:#a6e22e>convolution</span>(<span style=color:#a6e22e>x</span>, <span style=color:#a6e22e>y</span>, <span style=color:#a6e22e>kernel</span>){
</span></span><span style=display:flex><span>    <span style=color:#66d9ef>let</span> <span style=color:#a6e22e>r</span> <span style=color:#f92672>=</span> <span style=color:#ae81ff>0.0</span>;
</span></span><span style=display:flex><span>    <span style=color:#66d9ef>let</span> <span style=color:#a6e22e>g</span> <span style=color:#f92672>=</span> <span style=color:#ae81ff>0.0</span>; 
</span></span><span style=display:flex><span>    <span style=color:#66d9ef>let</span> <span style=color:#a6e22e>b</span> <span style=color:#f92672>=</span> <span style=color:#ae81ff>0.0</span>;
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>    <span style=color:#66d9ef>for</span>(<span style=color:#66d9ef>let</span> <span style=color:#a6e22e>i</span> <span style=color:#f92672>=</span> <span style=color:#ae81ff>0</span>; <span style=color:#a6e22e>i</span> <span style=color:#f92672>&lt;</span> <span style=color:#a6e22e>matrixSize</span>; <span style=color:#a6e22e>i</span><span style=color:#f92672>++</span>){
</span></span><span style=display:flex><span>        <span style=color:#66d9ef>for</span>(<span style=color:#66d9ef>let</span> <span style=color:#a6e22e>j</span> <span style=color:#f92672>=</span> <span style=color:#ae81ff>0</span>; <span style=color:#a6e22e>j</span> <span style=color:#f92672>&lt;</span> <span style=color:#a6e22e>matrixSize</span>; <span style=color:#a6e22e>j</span><span style=color:#f92672>++</span>){
</span></span><span style=display:flex><span>            
</span></span><span style=display:flex><span>            <span style=color:#66d9ef>let</span> <span style=color:#a6e22e>index</span> <span style=color:#f92672>=</span> ((<span style=color:#a6e22e>x</span> <span style=color:#f92672>+</span> <span style=color:#a6e22e>i</span>) <span style=color:#f92672>+</span> <span style=color:#a6e22e>img</span>.<span style=color:#a6e22e>width</span> <span style=color:#f92672>*</span> (<span style=color:#a6e22e>y</span> <span style=color:#f92672>+</span> <span style=color:#a6e22e>j</span>)) <span style=color:#f92672>*</span> <span style=color:#ae81ff>4</span>;
</span></span><span style=display:flex><span>            <span style=color:#a6e22e>index</span> <span style=color:#f92672>=</span> <span style=color:#a6e22e>constrain</span>(<span style=color:#a6e22e>index</span>, <span style=color:#ae81ff>0</span>, <span style=color:#a6e22e>img</span>.<span style=color:#a6e22e>pixels</span>.<span style=color:#a6e22e>length</span> <span style=color:#f92672>-</span> <span style=color:#ae81ff>1</span>);
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>            <span style=color:#a6e22e>r</span> <span style=color:#f92672>+=</span> <span style=color:#a6e22e>img</span>.<span style=color:#a6e22e>pixels</span>[<span style=color:#a6e22e>index</span>] <span style=color:#f92672>*</span> <span style=color:#a6e22e>kernel</span>[<span style=color:#a6e22e>i</span>][<span style=color:#a6e22e>j</span>];
</span></span><span style=display:flex><span>            <span style=color:#a6e22e>g</span> <span style=color:#f92672>+=</span> <span style=color:#a6e22e>img</span>.<span style=color:#a6e22e>pixels</span>[<span style=color:#a6e22e>index</span> <span style=color:#f92672>+</span> <span style=color:#ae81ff>1</span>] <span style=color:#f92672>*</span> <span style=color:#a6e22e>kernel</span>[<span style=color:#a6e22e>i</span>][<span style=color:#a6e22e>j</span>];
</span></span><span style=display:flex><span>            <span style=color:#a6e22e>b</span> <span style=color:#f92672>+=</span> <span style=color:#a6e22e>img</span>.<span style=color:#a6e22e>pixels</span>[<span style=color:#a6e22e>index</span> <span style=color:#f92672>+</span> <span style=color:#ae81ff>2</span>] <span style=color:#f92672>*</span> <span style=color:#a6e22e>kernel</span>[<span style=color:#a6e22e>i</span>][<span style=color:#a6e22e>j</span>];
</span></span><span style=display:flex><span>        }
</span></span><span style=display:flex><span>    }
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>    <span style=color:#66d9ef>return</span> {
</span></span><span style=display:flex><span>        <span style=color:#a6e22e>r</span><span style=color:#f92672>:</span> <span style=color:#a6e22e>constrain</span>(<span style=color:#a6e22e>r</span>, <span style=color:#ae81ff>0</span>, <span style=color:#ae81ff>255</span>),
</span></span><span style=display:flex><span>        <span style=color:#a6e22e>g</span><span style=color:#f92672>:</span> <span style=color:#a6e22e>constrain</span>(<span style=color:#a6e22e>g</span>, <span style=color:#ae81ff>0</span>, <span style=color:#ae81ff>255</span>),
</span></span><span style=display:flex><span>        <span style=color:#a6e22e>b</span><span style=color:#f92672>:</span> <span style=color:#a6e22e>constrain</span>(<span style=color:#a6e22e>b</span>, <span style=color:#ae81ff>0</span>, <span style=color:#ae81ff>255</span>)
</span></span><span style=display:flex><span>    }
</span></span><span style=display:flex><span>}
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span><span style=color:#66d9ef>function</span> <span style=color:#a6e22e>convolveImage</span>(<span style=color:#a6e22e>kernel</span>){
</span></span><span style=display:flex><span>    <span style=color:#a6e22e>resetImage</span>();
</span></span><span style=display:flex><span>    <span style=color:#a6e22e>img</span>.<span style=color:#a6e22e>loadPixels</span>();
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>    <span style=color:#66d9ef>for</span> (<span style=color:#66d9ef>let</span> <span style=color:#a6e22e>x</span> <span style=color:#f92672>=</span> <span style=color:#ae81ff>0</span>; <span style=color:#a6e22e>x</span> <span style=color:#f92672>&lt;</span> <span style=color:#a6e22e>img</span>.<span style=color:#a6e22e>width</span>; <span style=color:#a6e22e>x</span><span style=color:#f92672>++</span>) {
</span></span><span style=display:flex><span>        <span style=color:#66d9ef>for</span> (<span style=color:#66d9ef>let</span> <span style=color:#a6e22e>y</span> <span style=color:#f92672>=</span> <span style=color:#ae81ff>0</span>; <span style=color:#a6e22e>y</span> <span style=color:#f92672>&lt;</span> <span style=color:#a6e22e>img</span>.<span style=color:#a6e22e>height</span>; <span style=color:#a6e22e>y</span><span style=color:#f92672>++</span>) {
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>            <span style=color:#66d9ef>let</span> <span style=color:#a6e22e>index</span> <span style=color:#f92672>=</span> (<span style=color:#a6e22e>x</span> <span style=color:#f92672>+</span> <span style=color:#a6e22e>y</span> <span style=color:#f92672>*</span> <span style=color:#a6e22e>img</span>.<span style=color:#a6e22e>width</span>) <span style=color:#f92672>*</span> <span style=color:#ae81ff>4</span>;
</span></span><span style=display:flex><span>            <span style=color:#66d9ef>let</span> <span style=color:#a6e22e>result</span> <span style=color:#f92672>=</span> <span style=color:#a6e22e>convolution</span>(<span style=color:#a6e22e>x</span>, <span style=color:#a6e22e>y</span>, <span style=color:#a6e22e>kernel</span>);
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>            <span style=color:#a6e22e>img</span>.<span style=color:#a6e22e>pixels</span>[<span style=color:#a6e22e>index</span>] <span style=color:#f92672>=</span> <span style=color:#a6e22e>result</span>.<span style=color:#a6e22e>r</span>;
</span></span><span style=display:flex><span>            <span style=color:#a6e22e>img</span>.<span style=color:#a6e22e>pixels</span>[<span style=color:#a6e22e>index</span> <span style=color:#f92672>+</span> <span style=color:#ae81ff>1</span>] <span style=color:#f92672>=</span> <span style=color:#a6e22e>result</span>.<span style=color:#a6e22e>g</span>;
</span></span><span style=display:flex><span>            <span style=color:#a6e22e>img</span>.<span style=color:#a6e22e>pixels</span>[<span style=color:#a6e22e>index</span> <span style=color:#f92672>+</span> <span style=color:#ae81ff>2</span>] <span style=color:#f92672>=</span> <span style=color:#a6e22e>result</span>.<span style=color:#a6e22e>b</span>;
</span></span><span style=display:flex><span>            <span style=color:#a6e22e>img</span>.<span style=color:#a6e22e>pixels</span>[<span style=color:#a6e22e>index</span> <span style=color:#f92672>+</span> <span style=color:#ae81ff>3</span>] <span style=color:#f92672>=</span> <span style=color:#a6e22e>alpha</span>(<span style=color:#a6e22e>color</span>(<span style=color:#a6e22e>result</span>.<span style=color:#a6e22e>r</span>, <span style=color:#a6e22e>result</span>.<span style=color:#a6e22e>g</span>, <span style=color:#a6e22e>result</span>.<span style=color:#a6e22e>b</span>));
</span></span><span style=display:flex><span>        }
</span></span><span style=display:flex><span>    }
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>    <span style=color:#a6e22e>stroke</span>(<span style=color:#ae81ff>300</span>, <span style=color:#ae81ff>100</span>, <span style=color:#ae81ff>80</span>);
</span></span><span style=display:flex><span>    <span style=color:#a6e22e>img</span>.<span style=color:#a6e22e>updatePixels</span>();
</span></span><span style=display:flex><span>    <span style=color:#a6e22e>showHistogram</span>();
</span></span><span style=display:flex><span>}
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span><span style=color:#66d9ef>function</span> <span style=color:#a6e22e>resetImage</span>(){
</span></span><span style=display:flex><span>    <span style=color:#a6e22e>img</span>.<span style=color:#a6e22e>copy</span>(<span style=color:#a6e22e>file</span>, <span style=color:#ae81ff>0</span>, <span style=color:#ae81ff>0</span>, <span style=color:#a6e22e>file</span>.<span style=color:#a6e22e>width</span>, <span style=color:#a6e22e>file</span>.<span style=color:#a6e22e>height</span>, <span style=color:#ae81ff>0</span>, <span style=color:#ae81ff>0</span>, <span style=color:#a6e22e>file</span>.<span style=color:#a6e22e>width</span>, <span style=color:#a6e22e>file</span>.<span style=color:#a6e22e>height</span>);
</span></span><span style=display:flex><span>    <span style=color:#a6e22e>showHistogram</span>();
</span></span><span style=display:flex><span>}
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span><span style=color:#66d9ef>function</span> <span style=color:#a6e22e>brightnessControl</span>(<span style=color:#a6e22e>luma</span> <span style=color:#f92672>=</span> <span style=color:#a6e22e>y709</span>){
</span></span><span style=display:flex><span>    <span style=color:#a6e22e>resetImage</span>();
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>    <span style=color:#a6e22e>img</span>.<span style=color:#a6e22e>loadPixels</span>();
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>    <span style=color:#66d9ef>let</span> <span style=color:#a6e22e>percentage</span> <span style=color:#f92672>=</span> <span style=color:#a6e22e>slider</span>.<span style=color:#a6e22e>value</span>() <span style=color:#f92672>/</span> <span style=color:#ae81ff>100</span>;
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>    <span style=color:#66d9ef>for</span> (<span style=color:#66d9ef>let</span> <span style=color:#a6e22e>x</span> <span style=color:#f92672>=</span> <span style=color:#ae81ff>0</span>; <span style=color:#a6e22e>x</span> <span style=color:#f92672>&lt;</span> <span style=color:#a6e22e>img</span>.<span style=color:#a6e22e>width</span>; <span style=color:#a6e22e>x</span><span style=color:#f92672>++</span>) {
</span></span><span style=display:flex><span>        <span style=color:#66d9ef>for</span> (<span style=color:#66d9ef>let</span> <span style=color:#a6e22e>y</span> <span style=color:#f92672>=</span> <span style=color:#ae81ff>0</span>; <span style=color:#a6e22e>y</span> <span style=color:#f92672>&lt;</span> <span style=color:#a6e22e>img</span>.<span style=color:#a6e22e>height</span>; <span style=color:#a6e22e>y</span><span style=color:#f92672>++</span>) {
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>            <span style=color:#66d9ef>let</span> <span style=color:#a6e22e>index</span> <span style=color:#f92672>=</span> (<span style=color:#a6e22e>x</span> <span style=color:#f92672>+</span> <span style=color:#a6e22e>y</span> <span style=color:#f92672>*</span> <span style=color:#a6e22e>img</span>.<span style=color:#a6e22e>width</span>) <span style=color:#f92672>*</span> <span style=color:#ae81ff>4</span>;
</span></span><span style=display:flex><span>            
</span></span><span style=display:flex><span>            <span style=color:#a6e22e>rValue</span> <span style=color:#f92672>=</span> <span style=color:#a6e22e>img</span>.<span style=color:#a6e22e>pixels</span>[<span style=color:#a6e22e>index</span>] <span style=color:#f92672>*</span> <span style=color:#a6e22e>luma</span>[<span style=color:#ae81ff>0</span>] <span style=color:#f92672>*</span> <span style=color:#a6e22e>percentage</span>;
</span></span><span style=display:flex><span>            <span style=color:#a6e22e>gValue</span> <span style=color:#f92672>=</span> <span style=color:#a6e22e>img</span>.<span style=color:#a6e22e>pixels</span>[<span style=color:#a6e22e>index</span> <span style=color:#f92672>+</span> <span style=color:#ae81ff>1</span>] <span style=color:#f92672>*</span> <span style=color:#a6e22e>luma</span>[<span style=color:#ae81ff>1</span>] <span style=color:#f92672>*</span> <span style=color:#a6e22e>percentage</span>;
</span></span><span style=display:flex><span>            <span style=color:#a6e22e>bValue</span> <span style=color:#f92672>=</span> <span style=color:#a6e22e>img</span>.<span style=color:#a6e22e>pixels</span>[<span style=color:#a6e22e>index</span> <span style=color:#f92672>+</span> <span style=color:#ae81ff>2</span>] <span style=color:#f92672>*</span> <span style=color:#a6e22e>luma</span>[<span style=color:#ae81ff>2</span>] <span style=color:#f92672>*</span> <span style=color:#a6e22e>percentage</span>;
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>            <span style=color:#66d9ef>let</span> <span style=color:#a6e22e>result</span> <span style=color:#f92672>=</span> <span style=color:#a6e22e>rValue</span> <span style=color:#f92672>+</span> <span style=color:#a6e22e>gValue</span> <span style=color:#f92672>+</span> <span style=color:#a6e22e>bValue</span>;
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>            <span style=color:#a6e22e>img</span>.<span style=color:#a6e22e>pixels</span>[<span style=color:#a6e22e>index</span>] <span style=color:#f92672>=</span> <span style=color:#a6e22e>constrain</span>( <span style=color:#a6e22e>result</span>, <span style=color:#ae81ff>0</span>, <span style=color:#ae81ff>255</span>);
</span></span><span style=display:flex><span>            <span style=color:#a6e22e>img</span>.<span style=color:#a6e22e>pixels</span>[<span style=color:#a6e22e>index</span> <span style=color:#f92672>+</span> <span style=color:#ae81ff>1</span>] <span style=color:#f92672>=</span> <span style=color:#a6e22e>constrain</span>( <span style=color:#a6e22e>result</span>, <span style=color:#ae81ff>0</span>, <span style=color:#ae81ff>255</span>);
</span></span><span style=display:flex><span>            <span style=color:#a6e22e>img</span>.<span style=color:#a6e22e>pixels</span>[<span style=color:#a6e22e>index</span> <span style=color:#f92672>+</span> <span style=color:#ae81ff>2</span>] <span style=color:#f92672>=</span> <span style=color:#a6e22e>constrain</span>( <span style=color:#a6e22e>result</span>, <span style=color:#ae81ff>0</span>, <span style=color:#ae81ff>255</span>);
</span></span><span style=display:flex><span>            <span style=color:#a6e22e>img</span>.<span style=color:#a6e22e>pixels</span>[<span style=color:#a6e22e>index</span> <span style=color:#f92672>+</span> <span style=color:#ae81ff>3</span>] <span style=color:#f92672>=</span> <span style=color:#a6e22e>alpha</span>(<span style=color:#a6e22e>color</span>(<span style=color:#a6e22e>img</span>.<span style=color:#a6e22e>pixels</span>[<span style=color:#a6e22e>index</span>], <span style=color:#a6e22e>img</span>.<span style=color:#a6e22e>pixels</span>[<span style=color:#a6e22e>index</span> <span style=color:#f92672>+</span> <span style=color:#ae81ff>1</span>], <span style=color:#a6e22e>img</span>.<span style=color:#a6e22e>pixels</span>[<span style=color:#a6e22e>index</span> <span style=color:#f92672>+</span> <span style=color:#ae81ff>2</span>]));
</span></span><span style=display:flex><span>        }
</span></span><span style=display:flex><span>    }
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>    <span style=color:#a6e22e>img</span>.<span style=color:#a6e22e>updatePixels</span>();
</span></span><span style=display:flex><span>    <span style=color:#a6e22e>showHistogram</span>();
</span></span><span style=display:flex><span>}
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span><span style=color:#66d9ef>function</span> <span style=color:#a6e22e>selectedValue</span>(){
</span></span><span style=display:flex><span>    <span style=color:#66d9ef>switch</span> (<span style=color:#a6e22e>selection</span>.<span style=color:#a6e22e>value</span>()) {
</span></span><span style=display:flex><span>        <span style=color:#66d9ef>case</span> <span style=color:#e6db74>&#39;Y601&#39;</span><span style=color:#f92672>:</span>
</span></span><span style=display:flex><span>            <span style=color:#a6e22e>slider</span>.<span style=color:#a6e22e>value</span>(<span style=color:#ae81ff>100</span>);
</span></span><span style=display:flex><span>            <span style=color:#a6e22e>brightnessControl</span>(<span style=color:#a6e22e>y601</span>);
</span></span><span style=display:flex><span>            <span style=color:#66d9ef>break</span>;
</span></span><span style=display:flex><span>        <span style=color:#66d9ef>case</span> <span style=color:#e6db74>&#39;Y240&#39;</span><span style=color:#f92672>:</span>
</span></span><span style=display:flex><span>            <span style=color:#a6e22e>slider</span>.<span style=color:#a6e22e>value</span>(<span style=color:#ae81ff>100</span>);
</span></span><span style=display:flex><span>            <span style=color:#a6e22e>luma</span> <span style=color:#f92672>=</span> <span style=color:#a6e22e>y240</span>;
</span></span><span style=display:flex><span>            <span style=color:#a6e22e>brightnessControl</span>(<span style=color:#a6e22e>y240</span>);
</span></span><span style=display:flex><span>            <span style=color:#66d9ef>break</span>;
</span></span><span style=display:flex><span>        <span style=color:#66d9ef>case</span> <span style=color:#e6db74>&#39;Y709&#39;</span><span style=color:#f92672>:</span>
</span></span><span style=display:flex><span>            <span style=color:#a6e22e>slider</span>.<span style=color:#a6e22e>value</span>(<span style=color:#ae81ff>100</span>);
</span></span><span style=display:flex><span>            <span style=color:#a6e22e>luma</span> <span style=color:#f92672>=</span> <span style=color:#a6e22e>y709</span>;
</span></span><span style=display:flex><span>            <span style=color:#a6e22e>brightnessControl</span>(<span style=color:#a6e22e>y709</span>);
</span></span><span style=display:flex><span>            <span style=color:#66d9ef>break</span>;
</span></span><span style=display:flex><span>        <span style=color:#66d9ef>case</span> <span style=color:#e6db74>&#39;Y2020&#39;</span><span style=color:#f92672>:</span>
</span></span><span style=display:flex><span>            <span style=color:#a6e22e>slider</span>.<span style=color:#a6e22e>value</span>(<span style=color:#ae81ff>100</span>);
</span></span><span style=display:flex><span>            <span style=color:#a6e22e>luma</span> <span style=color:#f92672>=</span> <span style=color:#a6e22e>y2020</span>;
</span></span><span style=display:flex><span>            <span style=color:#a6e22e>brightnessControl</span>(<span style=color:#a6e22e>y2020</span>);
</span></span><span style=display:flex><span>            <span style=color:#66d9ef>break</span>;
</span></span><span style=display:flex><span>        <span style=color:#66d9ef>default</span><span style=color:#f92672>:</span>
</span></span><span style=display:flex><span>            <span style=color:#a6e22e>slider</span>.<span style=color:#a6e22e>value</span>(<span style=color:#ae81ff>100</span>);
</span></span><span style=display:flex><span>            <span style=color:#a6e22e>lightnessControl</span>();
</span></span><span style=display:flex><span>            <span style=color:#66d9ef>break</span>;
</span></span><span style=display:flex><span>    }
</span></span><span style=display:flex><span>}
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span><span style=color:#66d9ef>function</span> <span style=color:#a6e22e>lightnessControl</span>(){
</span></span><span style=display:flex><span>    <span style=color:#a6e22e>resetImage</span>();
</span></span><span style=display:flex><span>    <span style=color:#a6e22e>img</span>.<span style=color:#a6e22e>loadPixels</span>();
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>    <span style=color:#66d9ef>let</span> <span style=color:#a6e22e>intensity</span> <span style=color:#f92672>=</span> <span style=color:#ae81ff>0</span>;
</span></span><span style=display:flex><span>    <span style=color:#66d9ef>for</span> (<span style=color:#66d9ef>let</span> <span style=color:#a6e22e>x</span> <span style=color:#f92672>=</span> <span style=color:#ae81ff>0</span>; <span style=color:#a6e22e>x</span> <span style=color:#f92672>&lt;</span> <span style=color:#a6e22e>img</span>.<span style=color:#a6e22e>width</span>; <span style=color:#a6e22e>x</span><span style=color:#f92672>++</span>) {
</span></span><span style=display:flex><span>        <span style=color:#66d9ef>for</span> (<span style=color:#66d9ef>let</span> <span style=color:#a6e22e>y</span> <span style=color:#f92672>=</span> <span style=color:#ae81ff>0</span>; <span style=color:#a6e22e>y</span> <span style=color:#f92672>&lt;</span> <span style=color:#a6e22e>img</span>.<span style=color:#a6e22e>height</span>; <span style=color:#a6e22e>y</span><span style=color:#f92672>++</span>) {
</span></span><span style=display:flex><span>                
</span></span><span style=display:flex><span>            <span style=color:#66d9ef>let</span> <span style=color:#a6e22e>index</span> <span style=color:#f92672>=</span> (<span style=color:#a6e22e>x</span> <span style=color:#f92672>+</span> <span style=color:#a6e22e>y</span> <span style=color:#f92672>*</span> <span style=color:#a6e22e>img</span>.<span style=color:#a6e22e>width</span>) <span style=color:#f92672>*</span> <span style=color:#ae81ff>4</span>;
</span></span><span style=display:flex><span>            
</span></span><span style=display:flex><span>            <span style=color:#66d9ef>if</span>(<span style=color:#a6e22e>selection</span>.<span style=color:#a6e22e>value</span>() <span style=color:#f92672>==</span> <span style=color:#e6db74>&#39;Intensity&#39;</span>){
</span></span><span style=display:flex><span>                <span style=color:#a6e22e>intensity</span> <span style=color:#f92672>=</span> <span style=color:#a6e22e>img</span>.<span style=color:#a6e22e>pixels</span>[<span style=color:#a6e22e>index</span>] <span style=color:#f92672>/</span> <span style=color:#ae81ff>3</span> <span style=color:#f92672>+</span> <span style=color:#a6e22e>img</span>.<span style=color:#a6e22e>pixels</span>[<span style=color:#a6e22e>index</span> <span style=color:#f92672>+</span> <span style=color:#ae81ff>1</span>] <span style=color:#f92672>/</span> <span style=color:#ae81ff>3</span> <span style=color:#f92672>+</span> <span style=color:#a6e22e>img</span>.<span style=color:#a6e22e>pixels</span>[<span style=color:#a6e22e>index</span> <span style=color:#f92672>+</span> <span style=color:#ae81ff>2</span>] <span style=color:#f92672>/</span> <span style=color:#ae81ff>3</span>;
</span></span><span style=display:flex><span>            }
</span></span><span style=display:flex><span>            <span style=color:#66d9ef>else</span> <span style=color:#66d9ef>if</span>(<span style=color:#a6e22e>selection</span>.<span style=color:#a6e22e>value</span>() <span style=color:#f92672>==</span> <span style=color:#e6db74>&#39;HSV value&#39;</span>){
</span></span><span style=display:flex><span>                <span style=color:#a6e22e>intensity</span> <span style=color:#f92672>=</span> <span style=color:#a6e22e>max</span>(<span style=color:#a6e22e>img</span>.<span style=color:#a6e22e>pixels</span>[<span style=color:#a6e22e>index</span>], <span style=color:#a6e22e>img</span>.<span style=color:#a6e22e>pixels</span>[<span style=color:#a6e22e>index</span> <span style=color:#f92672>+</span> <span style=color:#ae81ff>1</span>], <span style=color:#a6e22e>img</span>.<span style=color:#a6e22e>pixels</span>[<span style=color:#a6e22e>index</span> <span style=color:#f92672>+</span> <span style=color:#ae81ff>2</span>]);
</span></span><span style=display:flex><span>            }
</span></span><span style=display:flex><span>            <span style=color:#66d9ef>else</span>{
</span></span><span style=display:flex><span>                <span style=color:#66d9ef>let</span> <span style=color:#a6e22e>aux</span> <span style=color:#f92672>=</span> (<span style=color:#a6e22e>max</span>(<span style=color:#a6e22e>img</span>.<span style=color:#a6e22e>pixels</span>[<span style=color:#a6e22e>index</span>], <span style=color:#a6e22e>img</span>.<span style=color:#a6e22e>pixels</span>[<span style=color:#a6e22e>index</span> <span style=color:#f92672>+</span> <span style=color:#ae81ff>1</span>], <span style=color:#a6e22e>img</span>.<span style=color:#a6e22e>pixels</span>[<span style=color:#a6e22e>index</span> <span style=color:#f92672>+</span> <span style=color:#ae81ff>2</span>]));
</span></span><span style=display:flex><span>                <span style=color:#66d9ef>let</span> <span style=color:#a6e22e>aux2</span> <span style=color:#f92672>=</span> (<span style=color:#a6e22e>min</span>(<span style=color:#a6e22e>img</span>.<span style=color:#a6e22e>pixels</span>[<span style=color:#a6e22e>index</span>], <span style=color:#a6e22e>img</span>.<span style=color:#a6e22e>pixels</span>[<span style=color:#a6e22e>index</span> <span style=color:#f92672>+</span> <span style=color:#ae81ff>1</span>], <span style=color:#a6e22e>img</span>.<span style=color:#a6e22e>pixels</span>[<span style=color:#a6e22e>index</span> <span style=color:#f92672>+</span> <span style=color:#ae81ff>2</span>]));
</span></span><span style=display:flex><span>                <span style=color:#a6e22e>intensity</span> <span style=color:#f92672>=</span> <span style=color:#a6e22e>aux</span> <span style=color:#f92672>/</span> <span style=color:#ae81ff>2</span> <span style=color:#f92672>+</span> <span style=color:#a6e22e>aux2</span> <span style=color:#f92672>/</span> <span style=color:#ae81ff>2</span>;
</span></span><span style=display:flex><span>            }
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>            <span style=color:#a6e22e>intensity</span> <span style=color:#f92672>*=</span> <span style=color:#a6e22e>slider</span>.<span style=color:#a6e22e>value</span>() <span style=color:#f92672>/</span> <span style=color:#ae81ff>100</span>;
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>            <span style=color:#a6e22e>img</span>.<span style=color:#a6e22e>pixels</span>[<span style=color:#a6e22e>index</span>] <span style=color:#f92672>=</span> <span style=color:#a6e22e>intensity</span>;
</span></span><span style=display:flex><span>            <span style=color:#a6e22e>img</span>.<span style=color:#a6e22e>pixels</span>[<span style=color:#a6e22e>index</span> <span style=color:#f92672>+</span> <span style=color:#ae81ff>1</span>] <span style=color:#f92672>=</span> <span style=color:#a6e22e>intensity</span>;
</span></span><span style=display:flex><span>            <span style=color:#a6e22e>img</span>.<span style=color:#a6e22e>pixels</span>[<span style=color:#a6e22e>index</span> <span style=color:#f92672>+</span> <span style=color:#ae81ff>2</span>] <span style=color:#f92672>=</span> <span style=color:#a6e22e>intensity</span>;
</span></span><span style=display:flex><span>            <span style=color:#75715e>//img.pixels[index + 3] = alpha(color(intensity, intensity, intensity));
</span></span></span><span style=display:flex><span><span style=color:#75715e></span>        }
</span></span><span style=display:flex><span>    }
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>    <span style=color:#a6e22e>img</span>.<span style=color:#a6e22e>updatePixels</span>();
</span></span><span style=display:flex><span>    <span style=color:#a6e22e>showHistogram</span>();
</span></span><span style=display:flex><span>}
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span><span style=color:#66d9ef>function</span> <span style=color:#a6e22e>showHistogram</span>(){
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>    <span style=color:#a6e22e>noStroke</span>();
</span></span><span style=display:flex><span>    <span style=color:#a6e22e>fill</span>(<span style=color:#ae81ff>255</span>,<span style=color:#ae81ff>204</span>, <span style=color:#ae81ff>0</span>);
</span></span><span style=display:flex><span>    <span style=color:#a6e22e>img</span>.<span style=color:#a6e22e>loadPixels</span>();
</span></span><span style=display:flex><span>    
</span></span><span style=display:flex><span>    <span style=color:#66d9ef>for</span>(<span style=color:#66d9ef>let</span> <span style=color:#a6e22e>i</span> <span style=color:#f92672>=</span> <span style=color:#ae81ff>0</span>; <span style=color:#a6e22e>i</span> <span style=color:#f92672>&lt;</span> <span style=color:#ae81ff>256</span>; <span style=color:#a6e22e>i</span><span style=color:#f92672>++</span>){
</span></span><span style=display:flex><span>        <span style=color:#a6e22e>histogram</span>[<span style=color:#a6e22e>i</span>] <span style=color:#f92672>=</span> <span style=color:#ae81ff>0</span>;
</span></span><span style=display:flex><span>    }
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>    <span style=color:#66d9ef>for</span>(<span style=color:#66d9ef>let</span> <span style=color:#a6e22e>i</span> <span style=color:#f92672>=</span> <span style=color:#ae81ff>0</span>; <span style=color:#a6e22e>i</span> <span style=color:#f92672>&lt;</span> <span style=color:#a6e22e>img</span>.<span style=color:#a6e22e>pixels</span>.<span style=color:#a6e22e>length</span>; <span style=color:#a6e22e>i</span> <span style=color:#f92672>+=</span> <span style=color:#ae81ff>4</span>){
</span></span><span style=display:flex><span>        <span style=color:#66d9ef>let</span> <span style=color:#a6e22e>r</span> <span style=color:#f92672>=</span> <span style=color:#a6e22e>img</span>.<span style=color:#a6e22e>pixels</span>[<span style=color:#a6e22e>i</span>];
</span></span><span style=display:flex><span>        <span style=color:#66d9ef>let</span> <span style=color:#a6e22e>g</span> <span style=color:#f92672>=</span> <span style=color:#a6e22e>img</span>.<span style=color:#a6e22e>pixels</span>[<span style=color:#a6e22e>i</span> <span style=color:#f92672>+</span> <span style=color:#ae81ff>1</span>];
</span></span><span style=display:flex><span>        <span style=color:#66d9ef>let</span> <span style=color:#a6e22e>b</span> <span style=color:#f92672>=</span> <span style=color:#a6e22e>img</span>.<span style=color:#a6e22e>pixels</span>[<span style=color:#a6e22e>i</span> <span style=color:#f92672>+</span> <span style=color:#ae81ff>2</span>];
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>        <span style=color:#66d9ef>let</span> <span style=color:#a6e22e>intensity</span> <span style=color:#f92672>=</span> (<span style=color:#a6e22e>r</span> <span style=color:#f92672>+</span> <span style=color:#a6e22e>g</span> <span style=color:#f92672>+</span> <span style=color:#a6e22e>b</span>) <span style=color:#f92672>/</span> <span style=color:#ae81ff>3</span>;
</span></span><span style=display:flex><span>        <span style=color:#a6e22e>histogram</span>[<span style=color:#a6e22e>intensity</span>]<span style=color:#f92672>++</span>;
</span></span><span style=display:flex><span>    }
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>    <span style=color:#66d9ef>for</span>(<span style=color:#66d9ef>let</span> <span style=color:#a6e22e>i</span> <span style=color:#f92672>=</span> <span style=color:#ae81ff>0</span>; <span style=color:#a6e22e>i</span> <span style=color:#f92672>&lt;</span> <span style=color:#a6e22e>histogram</span>.<span style=color:#a6e22e>length</span>; <span style=color:#a6e22e>i</span><span style=color:#f92672>++</span>){                
</span></span><span style=display:flex><span>        <span style=color:#66d9ef>let</span> <span style=color:#a6e22e>x</span> <span style=color:#f92672>=</span> <span style=color:#a6e22e>map</span>(<span style=color:#a6e22e>i</span>, <span style=color:#ae81ff>0</span>, <span style=color:#ae81ff>255</span>, <span style=color:#ae81ff>0</span>, <span style=color:#a6e22e>img</span>.<span style=color:#a6e22e>width</span>);
</span></span><span style=display:flex><span>        <span style=color:#66d9ef>let</span> <span style=color:#a6e22e>y</span> <span style=color:#f92672>=</span> <span style=color:#a6e22e>constrain</span>(<span style=color:#a6e22e>histogram</span>[<span style=color:#a6e22e>i</span>], <span style=color:#ae81ff>0</span>, <span style=color:#ae81ff>400</span>);
</span></span><span style=display:flex><span>        <span style=color:#a6e22e>rect</span>(<span style=color:#a6e22e>x</span>, <span style=color:#a6e22e>img</span>.<span style=color:#a6e22e>height</span>, <span style=color:#a6e22e>width</span> <span style=color:#f92672>/</span> <span style=color:#ae81ff>256</span>, <span style=color:#f92672>-</span><span style=color:#a6e22e>y</span>);
</span></span><span style=display:flex><span>    }
</span></span><span style=display:flex><span>}
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span><span style=color:#66d9ef>function</span> <span style=color:#a6e22e>keyPressed</span>() {
</span></span><span style=display:flex><span>    <span style=color:#66d9ef>switch</span> (<span style=color:#a6e22e>key</span>) {
</span></span><span style=display:flex><span>        <span style=color:#66d9ef>case</span> <span style=color:#e6db74>&#39;1&#39;</span><span style=color:#f92672>:</span>
</span></span><span style=display:flex><span>            <span style=color:#a6e22e>convolveImage</span>(<span style=color:#a6e22e>identityMatrix</span>);
</span></span><span style=display:flex><span>            <span style=color:#66d9ef>break</span>;
</span></span><span style=display:flex><span>        <span style=color:#66d9ef>case</span> <span style=color:#e6db74>&#39;2&#39;</span><span style=color:#f92672>:</span>
</span></span><span style=display:flex><span>            <span style=color:#a6e22e>convolveImage</span>(<span style=color:#a6e22e>boxMatrix</span>);
</span></span><span style=display:flex><span>            <span style=color:#66d9ef>break</span>;
</span></span><span style=display:flex><span>        <span style=color:#66d9ef>case</span> <span style=color:#e6db74>&#39;3&#39;</span><span style=color:#f92672>:</span>
</span></span><span style=display:flex><span>            <span style=color:#a6e22e>convolveImage</span>(<span style=color:#a6e22e>sharpenMatrix</span>);
</span></span><span style=display:flex><span>            <span style=color:#66d9ef>break</span>;
</span></span><span style=display:flex><span>        <span style=color:#66d9ef>case</span> <span style=color:#e6db74>&#39;4&#39;</span><span style=color:#f92672>:</span>
</span></span><span style=display:flex><span>            <span style=color:#a6e22e>convolveImage</span>(<span style=color:#a6e22e>gaussianMatrix</span>);
</span></span><span style=display:flex><span>            <span style=color:#66d9ef>break</span>;
</span></span><span style=display:flex><span>        <span style=color:#66d9ef>case</span> <span style=color:#e6db74>&#39;5&#39;</span><span style=color:#f92672>:</span>
</span></span><span style=display:flex><span>            <span style=color:#a6e22e>convolveImage</span>(<span style=color:#a6e22e>ridgeDetectionMatrix</span>);
</span></span><span style=display:flex><span>            <span style=color:#66d9ef>break</span>;
</span></span><span style=display:flex><span>        <span style=color:#66d9ef>case</span> <span style=color:#e6db74>&#39;6&#39;</span><span style=color:#f92672>:</span>
</span></span><span style=display:flex><span>            <span style=color:#a6e22e>convolveImage</span>(<span style=color:#a6e22e>sobelMatrix</span>);
</span></span><span style=display:flex><span>            <span style=color:#66d9ef>break</span>;
</span></span><span style=display:flex><span>        <span style=color:#66d9ef>case</span> <span style=color:#e6db74>&#39;h&#39;</span><span style=color:#f92672>:</span>
</span></span><span style=display:flex><span>            <span style=color:#a6e22e>show</span> <span style=color:#f92672>=</span> <span style=color:#f92672>!</span><span style=color:#a6e22e>show</span>;
</span></span><span style=display:flex><span>            <span style=color:#66d9ef>break</span>;
</span></span><span style=display:flex><span>    }
</span></span><span style=display:flex><span>}
</span></span></code></pre></div></div></details><h2 id=referencias>Referencias
<a class=anchor href=#referencias>#</a></h2><ul><li><p><a href=https://editor.p5js.org/cassie/sketches/u2wNEyqgs>Código guía</a></p></li><li><p><a href="https://desktop.arcgis.com/es/arcmap/latest/manage-data/raster-and-images/convolution-function.htm#:~:text=La%20funci%C3%B3n%20de%20convoluci%C3%B3n%20realiza,realces%20basados%20en%20el%20kernel.">Función de convolución</a></p></li><li><p><a href=https://en.wikipedia.org/wiki/Kernel_%28image_processing%29>Kernel</a></p></li><li><p><a href=https://sbme-tutorials.github.io/2018/cv/notes/4_week4.html>Matrices para el kernel de una imagen</a></p></li><li><p><a href="https://medium.com/@bdhuma/6-basic-things-to-know-about-convolution-daef5e1bc411#:~:text=In%20image%20processing%2C%20convolution%20is,effect%20of%20the%20convolution%20process.">Convolución en imagenes</a></p></li><li><p><a href=https://nrsyed.com/2018/02/17/kernels-in-image-processing/>Kernels en el procesamiento de imágenes</a></p></li><li><p><a href=https://en.wikipedia.org/wiki/HSL_and_HSV#Lightness>Luminosidad</a></p></li><li><p><a href=https://www.dynamsoft.com/blog/insights/image-processing/image-processing-101-color-space-conversion/>Conversión del espacio de colo</a></p></li><li><p><a href=https://www.davidsalomon.name/DC2advertis/AppendH.pdf>Espacio de color HSV, HSL y RGB</a></p></li></ul></article><footer class=book-footer><div class="flex flex-wrap justify-between"><div><a class="flex align-center" href=https://github.com/Jsalasm/VisualComputing2022_2//commit/f7e15263bdfb3b8f4549aa9090278f76702aa60a title='Last modified by CamiloAyala | October 18, 2022' target=_blank rel=noopener><img src=/VisualComputing2022_2/svg/calendar.svg class=book-icon alt=Calendar>
<span>October 18, 2022</span></a></div></div><script>(function(){function e(e){const t=window.getSelection(),n=document.createRange();n.selectNodeContents(e),t.removeAllRanges(),t.addRange(n)}document.querySelectorAll("pre code").forEach(t=>{t.addEventListener("click",function(){e(t.parentElement),navigator.clipboard&&navigator.clipboard.writeText(t.parentElement.textContent)})})})()</script></footer><div class=book-comments></div><label for=menu-control class="hidden book-menu-overlay"></label></div><aside class=book-toc><div class=book-toc-content><nav id=TableOfContents><ul><li><a href=#kernel-de-imagen>Kernel de imagen</a><ul><li><a href=#1-introducción>1. Introducción</a></li><li><a href=#2-revisión-bibliográfica>2. Revisión bibliográfica</a></li><li><a href=#convolución>Convolución</a></li><li><a href=#kernel>Kernel</a></li><li><a href=#luminosidad>Luminosidad</a></li></ul></li><li><a href=#3-métodos>3. Métodos</a></li><li><a href=#4-resultados>4. Resultados</a><ul><li><a href=#referencias>Referencias</a></li></ul></li></ul></nav></div></aside></main></body></html>